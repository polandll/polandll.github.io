<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hardware Choices :: Apache Cassandra Documentation</title>
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Apache Cassandra Documentation&nbsp;&nbsp;&nbsp;<img src="../../../../_/img/cassandra_logo.png"></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Download</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Latest</a>
            <a class="navbar-item" href="#">3.x</a>
            <a class="navbar-item" href="#">3.0</a>
            <a class="navbar-item" href="#">2.1</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Latest</a>
            <a class="navbar-item" href="#">3.x</a>
            <a class="navbar-item" href="#">3.0</a>
            <a class="navbar-item" href="#">2.1</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Developer Mailing List</a>
            <a class="navbar-item" href="#">User Mailing List</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Blog</a>
	</div>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ASCIIDOC_POC" data-version="4.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">ASCIIDOC_POC</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">Cassandra Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../bugs.html">How to report bugs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../contactus.html">Contact us</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Cassandra</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../architecture/index.html">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/dynamo.html">Dynamo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/storage_engine.html">Storage engine</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/guarantees.html">Guarantees</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../new/index.html">What&#8217;s new</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../getting_started/index.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting_started/installing.html">Installing Cassandra</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting_started/configuring.html">Configuring Cassandra</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting_started/querying.html">Inserting and querying</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting_started/drivers.html">Client drivers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../getting_started/production.html">Production recommendations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data_modeling/index.html">Data Modeling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#cql/index.adoc{">CQL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/changes.html">Changes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/ddl.html">DDL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/dml.html">DML</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/types.html">Data types</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/operators.html">Operators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/definitions.html">Definitions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/indexes.html">Secondary indexes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/mvs.html">Materialized views</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/functions.html">Functions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/json.html">JSON</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/triggers.html">Triggers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cql/appendices.html">Appendices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/index.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Operating</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools/index.html">Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/index.html">Development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/index.html">Plug-ins</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting/index.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../faq/index.html">FAQ</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">ASCIIDOC_POC</span>
    <span class="version">4.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">ASCIIDOC_POC</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">4.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">ASCIIDOC_POC</a></li>
    <li><a href="hardware.html">Hardware Choices</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///Users/lorina.poland/CLONES/cassandra-examples/rst-to-asciidoc-tests/ASCIIDOC/modules/cassandra/pages/operating/hardware.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Hardware Choices</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Like most databases, Cassandra throughput improves with more CPU cores,
more RAM, and faster disks. While Cassandra can be made to run on small
servers for testing or development environments (including Raspberry
Pis), a minimal production server requires at least 2 cores, and at
least 8GB of RAM. Typical production servers have 8 or more cores and at
least 32GB of RAM.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cpu"><a class="anchor" href="#cpu"></a>CPU</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cassandra is highly concurrent, handling many simultaneous requests
(both read and write) using multiple threads running on as many CPU
cores as possible. The Cassandra write path tends to be heavily
optimized (writing to the commitlog and then inserting the data into the
memtable), so writes, in particular, tend to be CPU bound. Consequently,
adding additional CPU cores often increases throughput of both reads and
writes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="memory"><a class="anchor" href="#memory"></a>Memory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cassandra runs within a Java VM, which will pre-allocate a fixed size
heap (java&#8217;s Xmx system parameter). In addition to the heap, Cassandra
will use significant amounts of RAM offheap for compression metadata,
bloom filters, row, key, and counter caches, and an in process page
cache. Finally, Cassandra will take advantage of the operating system&#8217;s
page cache, storing recently accessed portions files in RAM for rapid
re-use.</p>
</div>
<div class="paragraph">
<p>For optimal performance, operators should benchmark and tune their
clusters based on their individual workload. However, basic guidelines
suggest:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ECC RAM should always be used, as Cassandra has few internal
safeguards to protect against bit level corruption</p>
</li>
<li>
<p>The Cassandra heap should be no less than 2GB, and no more than 50% of
your system RAM</p>
</li>
<li>
<p>Heaps smaller than 12GB should consider ParNew/ConcurrentMarkSweep
garbage collection</p>
</li>
<li>
<p>Heaps larger than 12GB should consider G1GC</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="disks"><a class="anchor" href="#disks"></a>Disks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cassandra persists data to disk for two very different purposes. The
first is to the commitlog when a new write is made so that it can be
replayed after a crash or system shutdown. The second is to the data
directory when thresholds are exceeded and memtables are flushed to disk
as SSTables.</p>
</div>
<div class="paragraph">
<p>Commitlogs receive every write made to a Cassandra node and have the
potential to block client operations, but they are only ever read on
node start-up. SSTable (data file) writes on the other hand occur
asynchronously, but are read to satisfy client look-ups. SSTables are
also periodically merged and rewritten in a process called compaction.
The data held in the commitlog directory is data that has not been
permanently saved to the SSTable data directories - it will be
periodically purged once it is flushed to the SSTable data files.</p>
</div>
<div class="paragraph">
<p>Cassandra performs very well on both spinning hard drives and solid
state disks. In both cases, Cassandra&#8217;s sorted immutable SSTables allow
for linear reads, few seeks, and few overwrites, maximizing throughput
for HDDs and lifespan of SSDs by avoiding write amplification. However,
when using spinning disks, it&#8217;s important that the commitlog
(<code>commitlog_directory</code>) be on one physical disk (not simply a partition,
but a physical disk), and the data files (<code>data_file_directories</code>) be
set to a separate physical disk. By separating the commitlog from the
data directory, writes can benefit from sequential appends to the
commitlog without having to seek around the platter as reads request
data from various SSTables on disk.</p>
</div>
<div class="paragraph">
<p>In most cases, Cassandra is designed to provide redundancy via multiple
independent, inexpensive servers. For this reason, using NFS or a SAN
for data directories is an antipattern and should typically be avoided.
Similarly, servers with multiple disks are often better served by using
RAID0 or JBOD than RAID1 or RAID5 - replication provided by Cassandra
obsoletes the need for replication at the disk layer, so it&#8217;s typically
recommended that operators take advantage of the additional throughput
of RAID0 rather than protecting against failures with RAID1 or RAID5.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="common-cloud-choices"><a class="anchor" href="#common-cloud-choices"></a>Common Cloud Choices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many large users of Cassandra run in various clouds, including AWS,
Azure, and GCE - Cassandra will happily run in any of these
environments. Users should choose similar hardware to what would be
needed in physical space. In EC2, popular options include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>i2 instances, which provide both a high RAM:CPU ratio and local
ephemeral SSDs</p>
</li>
<li>
<p>m4.2xlarge / c4.4xlarge instances, which provide modern CPUs, enhanced
networking and work well with EBS GP2 (SSD) storage</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generally, disk and network performance increases with instance size and
generation, so newer generations of instances and larger instance types
within each family often perform better than their smaller or older
alternatives.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
